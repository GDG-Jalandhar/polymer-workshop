<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-scroll-header-panel/core-scroll-header-panel.html">
<link rel="import" href="../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../bower_components/core-icons/core-icons.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<polymer-element name="speaker-info" attributes="speaker opened" layout vertical fit>
    <template>
        <style>
        :host {
            position: fixed !important;
            background-color: #FFFFFF;
        }

        core-scroll-header-panel::shadow #condensedHeaderBg {
            background-color: #78A842;
        }

        core-toolbar {
            color: #F1F1F1;
            background-color: transparent;
        }

        core-toolbar a {
            color: #F1F1F1;
        }

        [content] {
            background: #ffffff;
        }

        #title {
            -webkit-transform-origin: 0;
            transform-origin: 0;
            font-size: 40px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-header {
            height: 260px;
            background: url(/images/drawer-image.png);
            background-size: cover;
            color: #FFFFFF;
            position: relative;
        }

        .card-header .single-line {
            position: absolute;
            bottom: 16px;
            left: 16px;
        }

        .card-header core-image {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .card-header .card-name {
            color: #FFFFFF;
            margin-left: 16px;
            font-size: 24px;
        }

        .group {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 8px 0;
            position: relative;
        }

        .item {
            padding: 10px 72px;
            color: rgb(102, 102, 102);
        }

        .item core-icon {
            position: absolute;
            left: 16px;
            top: 24px;
            color: rgb(33, 33, 33);
        }

        .item a {
            color: rgb(33, 33, 33);
            text-decoration: none;
        }

        .double-line-1 {
            margin-top: 5px;
            margin-bottom: 6px;
        }

        .double-line-2 {
            font-size: 13px;
            line-height: 13px;
            color: rgba(0, 0, 0, 0.4);
        }

        @media screen and (min-width: 640px) {
            :host {
                background-color: #eeeeee;
                position: absolute !important;
            }
            [content] {
                width: 640px;
                margin: 64px auto;
            }
            core-toolbar {
                color: #F1F1F1;
                background-color: #78A842;
            }
            #title {
                font-size: 1.3em;
            }
        }
        </style>
        <core-scroll-header-panel id="scrollHeaderPanel" condenses flex>
            <core-toolbar class="tall">
                <paper-icon-button icon="arrow-back" on-tap="{{closeInfo}}"></paper-icon-button>
                <div id="title" class="bottom indent">{{speaker.name}} {{speaker.surname}}</div>
            </core-toolbar>
            <div content>
                <div class="group">
                    <div class="item">
                        <div class="double-line-1">{{speaker.company}}</div>
                        <div class="double-line-2">{{speaker.title}}</div>
                    </div>
                    <div class="item">
                        <div class="double-line-1">{{speaker.bio}}</div>
                    </div>
                </div>
                <div class="group">
                    <template repeat="{{social in speaker.social}}">
                        <div class="item">
                            <a href="{{social.link}}" title="{{social.name}}" target="_blank">
                                <div class="double-line-1">{{social.name}}</div>
                                <div class="double-line-2">{{social.link}}</div>
                            </a>
                        </div>
                    </template>
                </div>
            </div>
        </core-scroll-header-panel>
    </template>
    <script>
    (function() {
        Polymer('speaker-info', {
            opened: false,
            domReady: function() {
                // custom transformation: scale header's title
                var titleStyle = this.$.title.style;
                this.$.scrollHeaderPanel.$.headerBg.style.background = 'url(images/speakers/' + this.speaker.thumbnailUrl + ') 0 / cover no-repeat';
                document.addEventListener('core-header-transform', function(e) {
                    var d = e.detail;
                    var m = d.height - d.condensedHeight;
                    var scale = Math.max(0.55, (m - d.y) / (m / 0.25) + 0.55);
                    titleStyle.transform = titleStyle.webkitTransform =
                        'scale(' + scale + ') translateZ(0)';
                });
            },
            willPrepare: function() {
                this.super();

                // Measure the core-scroll-header-panel, otherwise its height will
                // be messed up
                this.$.scrollHeaderPanel.measureHeaderHeight();

                // Reset the scroller so every time the user comes to the info page
                // so they see the full profile photo
                this.$.scrollHeaderPanel.scroller.scrollTop = 0;
            },
            closeInfo: function() {
                this.opened = false;
            }
        });
    })();
    </script>
</polymer-element>
