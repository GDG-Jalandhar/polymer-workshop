<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-image/core-image.html">
<link rel="import" href="../../bower_components/core-media-query/core-media-query.html">
<link rel="import" href="../../bower_components/core-pages/core-pages.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../elements/app-data.html">
<link rel="import" href="../elements/session-info/session-info.html">
<polymer-element name="program-page">
    <template>
        <link rel="stylesheet" href="program-page.css">
        <app-data id="data" scheduleResponse="{{schedule}}"></app-data>
        <core-media-query id="mq-phone" query="(min-width:320px) and (max-width:767px)" querymatches="{{isPhoneSize}}"></core-media-query>
        <!-- tabs -->
        <paper-tabs selected="{{selected}}">
            <template repeat="{{day in schedule}}">
                <paper-tab>{{day.dateReadable}}</paper-tab>
            </template>
        </paper-tabs>
        <!-- pages -->
        <core-pages selected="{{selected}}">
            <template repeat="{{day in schedule}}">
                <div class="card">
                    <div class="card-content">
                        <template repeat="{{slot in day.timeslots}}">
                            <div class="slot" layout horizontal>
                                <span class="schedule-time" auto-vertical>{{slot.startTime}}<br>{{slot.endTime}}</span>
                                <div layout vertical?="{{isPhoneSize}}" horizontal?="{{!isPhoneSize}}" flex>
                                    <template repeat="{{session in slot.sessions}}">
                                        <div class="session" layout vertical flex?="{{!isPhoneSize}}" on-tap="{{openSession}}">
                                            <h4 class="session-title">{{session.title}}</h4>
                                            <template repeat="{{speaker in session.speakers}}">
                                                <div class="speaker" layout horizontal>
                                                    <core-image _src="images/speakers/{{speaker.thumbnailUrl}}" class="image" sizing="cover" preload fade load></core-image>
                                                    <div class="detail" layout vertical>
                                                        <span class="name">{{speaker.name}} {{speaker.surname}}</span>
                                                        <span class="company">{{speaker.company}}</span>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </core-pages>
        <template if="{{opened}}">
            <session-info session="{{selectedSession}}" opened="{{opened}}" hidden?="{{!opened}}"></session-info>
        </template>
    </template>
    <script>
    (function() {
        Polymer('program-page', {
            selected: 0,
            openSession: function(e, detail, sender) {
                this.selectedSession = e.target.templateInstance.model.session;
                this.opened = true;
            }
        });
    })();
    </script>
</polymer-element>
